<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance III CSE AIML C</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            width: 100%;
            max-width: 400px;
            margin-bottom: 20px;
        }

        .roll-btn {
            background-color: #e0e0e0;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 15px 0;
            font-size: 16px;
            font-weight: bold;
            color: #333;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            user-select: none;
        }

        .roll-btn.absent {
            background-color: #ff4d4d;
            color: white;
            border-color: #ff0000;
        }

        .section-header {
            grid-column: span 4;
            text-align: center;
            font-size: 14px;
            color: #666;
            margin-top: 10px;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .action-area {
            width: 100%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn-main {
            padding: 15px;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        #generateBtn {
            background-color: #1976D2;
            color: white;
        }

        #copyBtn {
            background-color: #4CAF50;
            color: white;
            display: none;
        }

        textarea {
            width: 100%;
            height: 150px;
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-family: monospace;
            resize: none;
            display: none;
            box-sizing: border-box;
        }
    </style>
</head>
<body>

    <h2>III CSE AIML C</h2>

    <div class="grid-container" id="rollGrid"></div>

    <div class="action-area">
        <button id="generateBtn" class="btn-main" onclick="generateMessage()">Generate msg</button>
        <textarea id="outputBox" readonly></textarea>
        <button id="copyBtn" class="btn-main" onclick="copyText()">Copy Text</button>
    </div>

    <script>
        const regularRolls = [
            "D3","D4","D5","D6","D7","D8","D9",
            "E0","E1","E2","E3","E4","E5","E6","E7","E8","E9",
            "F0","F1","F2","F3","F4","F5","F6","F7","F8","F9",
            "G0","G1","G2","G3","G4","G5","G6","G7","G8","G9",
            "H0","H1","H2","H3","H4","H5","H6","H7","H8","H9",
            "J0","J1","J3","J4","J5","J6","J7","J8","J9",
            "K0","K1","K2","K3","K4","K5","K6","K7","K8"
        ];

        const lateralRolls = ["15","16","17","18","19"];

        const grid = document.getElementById('rollGrid');
        const totalCount = regularRolls.length + lateralRolls.length;

        function createButtons() {
            regularRolls.forEach(roll => {
                const btn = document.createElement('button');
                btn.className = 'roll-btn';
                btn.innerText = roll;
                btn.onclick = () => btn.classList.toggle('absent');
                grid.appendChild(btn);
            });

            const divider = document.createElement('div');
            divider.className = 'section-header';
            divider.innerText = "--- Lateral Entries ---";
            grid.appendChild(divider);

            lateralRolls.forEach(roll => {
                const btn = document.createElement('button');
                btn.className = 'roll-btn';
                btn.innerText = roll;
                btn.onclick = () => btn.classList.toggle('absent');
                grid.appendChild(btn);
            });
        }

        function getSession() {
            const now = new Date();
            const minutes = now.getHours() * 60 + now.getMinutes();

            const FN_start = 9*60 + 10;
            const FN_end   = 12*60 + 10;

            const AN_start = 12*60 + 50;
            const AN_end   = 15*60 + 50;

            if (minutes >= FN_start && minutes <= FN_end) return "FN";
            if (minutes >= AN_start && minutes <= AN_end) return "AN";
            return "";
        }

        function generateMessage() {
            const sessionLabel = getSession();

            const absentees = Array.from(document.querySelectorAll('.roll-btn.absent'))
                                    .map(btn => btn.innerText);

            // Separate regular & LE absentees
            const leAbsent = absentees.filter(r => lateralRolls.includes(r));
            const regularAbsent = absentees.filter(r => !lateralRolls.includes(r));

            // Create final absentee list
            const finalAbsentees = [];

            // Add regular absentees normally
            if (regularAbsent.length > 0) {
                finalAbsentees.push(...regularAbsent);
            }

            // Add LE group ONE TIME
            if (leAbsent.length > 0) {
                finalAbsentees.push("LE - " + leAbsent.join(" "));
            }

            const absent = absentees.length;
            const present = totalCount - absent;

            const today = new Date();
            const dateStr =
                String(today.getDate()).padStart(2,'0') + "/" +
                String(today.getMonth()+1).padStart(2,'0') + "/" +
                today.getFullYear();

            const sessionText = sessionLabel ? `${sessionLabel} Absentees :` : "Absentees :";

            const msg =
                `III CSE AIML C\n${dateStr} ${sessionText} ` +
                (finalAbsentees.length > 0 ? finalAbsentees.join(' ') : "None") +
                `\nAbsent - ${absent}\nPresent - ${present}\nTotal - ${totalCount}`;

            const output = document.getElementById('outputBox');
            output.style.display = "block";
            output.value = msg;

            document.getElementById('copyBtn').style.display = "block";

            window.scrollTo(0, document.body.scrollHeight);
        }

        function copyText() {
            const output = document.getElementById('outputBox');
            output.select();
            navigator.clipboard.writeText(output.value);
            alert("Message Copied!");
        }

        createButtons();
    </script>

</body>
</html>
